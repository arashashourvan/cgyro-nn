
Lmod is automatically replacing "PrgEnv-nvidia/8.5.0" with "PrgEnv-gnu/8.5.0".


Lmod is automatically replacing "nvidia/24.5" with "gcc-native/13.2".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-hdf5/1.14.3.1      3) cray-mpich/8.1.30
  2) cray-libsci/24.07.0     4) cray-netcdf/4.9.0.13

The following have been reloaded with a version change:
  1) cudatoolkit/12.4 => cudatoolkit/12.9


Currently Loaded Modules:
  1) craype-x86-milan          (cpe)   9) cray-libsci/24.07.0
  2) libfabric/1.22.0                 10) PrgEnv-gnu/8.5.0     (prgenv)
  3) craype-network-ofi        (cpe)  11) gcc-native/13.2      (c)
  4) conda/Miniforge3-24.7.1-0        12) cudatoolkit/12.9     (g)
  5) python/3.11                      13) nccl/2.24.3          (g)
  6) craype/2.7.32             (c)    14) pytorch/2.8.0
  7) cray-dsmml/0.3.0                 15) cray-hdf5/1.14.3.1
  8) cray-mpich/8.1.30         (mpi)  16) cray-netcdf/4.9.0.13

  Where:
   c:       Compiler
   cpe:     Cray Programming Environment Modules
   g:       built for GPU
   mpi:     MPI Providers
   prgenv:  Programming Environment Modules

 

Traceback (most recent call last):
  File "/pscratch/sd/a/arash/cgyro-nn/code/3DCNN/train_with_earlystop_rmse_deep.py", line 103, in <module>
    import train_with_earlystop_rmse  # executes main on import
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/a/arash/cgyro-nn/code/3DCNN/train_with_earlystop_rmse.py", line 174, in <module>
    pred = model(xb)
           ^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/a/arash/cgyro-nn/code/3DCNN/phi2flux_deep.py", line 146, in forward
    feats = self.encoder(x_flat)     # [B*T, F]
            ^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/a/arash/cgyro-nn/code/3DCNN/phi2flux_deep.py", line 82, in forward
    h = self.body(h)
        ^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/a/arash/cgyro-nn/code/3DCNN/phi2flux_deep.py", line 38, in forward
    h = self.conv1(x)
        ^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 717, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/common/software/nersc9/pytorch/2.8.0/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 712, in _conv_forward
    return F.conv3d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.53 GiB. GPU 0 has a total capacity of 39.38 GiB of which 1.46 GiB is free. Including non-PyTorch memory, this process has 37.91 GiB memory in use. Of the allocated memory 37.39 GiB is allocated by PyTorch, and 40.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
srun: error: nid001369: task 0: Exited with exit code 1
srun: Terminating StepId=44946870.0
